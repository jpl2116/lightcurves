####
#### R file to analyze lightcurve data output by 
#### lightcurve database
####
#### by James Long
#### date Jan 12, 2011
####

library(rpart)


## load data
data1 = read.table('outputRtest.txt',header=T,sep=';')
tfe = read.table('tfe.txt',header=T,sep=';')
names(data1)
nrow(data1)
head(data1)



##
## check that folding is being done correctly
##

find_curve = function(data1_row){
	curves_sub = subset(tfe,subset=(tfe$source_id == as.double(data1_row["features.source_id"])))
	return(curves_sub)
}

fold_curve = function(times,freq){
	number_periods = times * freq
	folded = number_periods - floor(number_periods)
	return(folded)
}

obs_vec = (1:nrow(data1))[data1$sources.classification == "Mira"]


for(i in obs_vec){
	relevant_curves = find_curve(data1[i,])
	par(mfcol=c(2,1))
	plot(relevant_curves[,2],relevant_curves[,3])
	folded_times = fold_curve(relevant_curves[,2],data1[i,"features.freq1_harmonics_freq_0"])
	plot(folded_times,relevant_curves[,3])
	Sys.sleep(1)
}




###
### determine frequency of sources by class name
###

table(data1$sources.classification,data1$sources.survey)


sum(unique(data1$sources.classification)[1] == data1$sources.classification)


unique(data1$sources.classification) == "Mira"

###
###
###
